#!/usr/bin/env sh

function check_vault_init {
  RESPONSE=$(curl --insecure --silent --header "X-Vault-Token: $VAULT_TOKEN" http://$VAULT_ADDR/v1/tss1/data/keygen_preparams)

  if echo "$RESPONSE" | grep -q '"data"'; then
    echo "Secrets exists."
    return 0
  else
    echo "Setting secrets..."
    return 1
  fi
}

function wait_vault {
    echo "Waiting for Vault..."

    while true
    do
        RESPONSE=$(curl --insecure --silent -H "X-Vault-Token: $VAULT_TOKEN" $VAULT_ADDR/v1/sys/health)

        if echo "$RESPONSE" | grep -q '"initialized":true'; then
            echo "Vault is initialized!"
            break
        fi

        echo "Vault is Initializing..."
        sleep 2
    done
}

function init_tss {
  curl -k -X POST -H "X-Vault-Token: $VAULT_TOKEN" \
    -d '{"type": "kv", "options": {"version": "2"}}' \
    $VAULT_ADDR/v1/sys/mounts/tss1

  curl -k -X POST -H "X-Vault-Token: $VAULT_TOKEN" \
      -d '{"type": "kv", "options": {"version": "2"}}' \
      $VAULT_ADDR/v1/sys/mounts/tss2

  curl -k -X POST -H "X-Vault-Token: $VAULT_TOKEN" \
      -d '{"type": "kv", "options": {"version": "2"}}' \
      $VAULT_ADDR/v1/sys/mounts/tss3

  echo "Initializing TSS 1"
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"value": "{\"PaillierSK\":{\"N\":25222539396214102132947645117922233593416310527922261576767907607209454161148886976687740431574376057717301376863337351866485660948587280403504333047565362634864942355235574974370280655547038889388126778626768745495789937343074376983433409811121185054635688712486168781113695875463482736079503428210169676308334530833939254903788354387280861868113597976139498558860029324728905034236387595729540429364624198142499381828274695128146897507978696565574138170172578682300653201107201844796079327428944058588394275048046535588206168347669132263451197928497591448865056897551369647572951678065293218262773535109517570063301,\"LambdaN\":12611269698107051066473822558961116796708155263961130788383953803604727080574443488343870215787188028858650688431668675933242830474293640201752166523782681317432471177617787487185140327773519444694063389313384372747894968671537188491716704905560592527317844356243084390556847937731741368039751714105084838154008241261454243447796086532479708781524180105490443551208392989750922769260216801420150334439469670438495082035278890685946845471301238500134216100126221853035754326896640128858144179658447569143559718996548863169793669510290518823845159656779366212898942225407056599595021864653058029691480332290256617987206,\"PhiN\":25222539396214102132947645117922233593416310527922261576767907607209454161148886976687740431574376057717301376863337351866485660948587280403504333047565362634864942355235574974370280655547038889388126778626768745495789937343074376983433409811121185054635688712486168781113695875463482736079503428210169676308016482522908486895592173064959417563048360210980887102416785979501845538520433602840300668878939340876990164070557781371893690942602477000268432200252443706071508653793280257716288359316895138287119437993097726339587339020581037647690319313558732425797884450814113199190043729306116059382960664580513235974412,\"P\":150891342892008580658638413715900709146437502755551199099303933791405935401292001882229020130305955511604989879569608191366019320577890618419676337008832733544995506129790473210447006147392030087682387887045119857095508770897363727579142004626039971697874459115593873160254895505626318195353306498612247624027,\"Q\":167156968138759427537542908605543595918800262403060257343939411435653560314661991007010740355378901753904227878147305564887187244798328946886029632911302242684149041184131113869343961964656890213592449167903689391523320556190730888181736610312819051369297987621662575222653053253550840684459564030392086464863},\"NTildei\":27522048145569981576385476070657020085925130726339017105732055245635131139617848779486234236089392739447177029230176776337417792840985410026305811898446122370628457991480751841368787992944674212855827136776106587708211623816096633385470508783942777769060242860553024607789618299480333621903785949269589743855899844781732294719464609693176227125635396506961291206642890240986520873279868204630398583955556159431730110625063162375117211307543187824440584752056647328233594782678897603405275933516376239252164516303232640795307757685973412817046088426802943281427373371681705483044019813362572029248015450975003456793397,\"H1i\":16517568479471580541042167147429887624339112445131695731362812965113271556999931499818506920295872359339618541473632721715590651347747155351693852424406909063273800991740936578905390940693930284712570022696272615200628747778340495713818589656470906148279108801537540281635961498936452198579197181393579833588271971375793237362898722119231386278352366524087073998056530952433549592269901646408479257883589277185145047553119070727427132500779070094700805261739909572847069577770555320557647528931722700347780859584941003633045209132957117021571486230238188597577097341756253345984078902464163897730250825619109443585525,\"H2i\":7009260890983307674042645873443598272360402291874184297628611268334644375502827051885602971774872550746932684397961239936661508751942327338374679890949524040617402859819754169960008995120441085537975312375011245160932483701011029053912892591633122502853519566790980511469316278839843627242914384033499665339269445033918946320801864810354356251335317386995536622835031324684861929125151890912785727964237447305235539333445504406193442566504156368203203389831716945872865325564528075805169478948659002126911172399429651055487198066475747305990261540384572530954665466045817671514939564054758032645426132833343419966435,\"Alpha\":24178785770298028035270144330521408366177012635516436515514285252609396045105742475132287920923959769687003596766445981073304522433616678002914754773901159001959974463126754423168234341647006144447075641205958141510051562440318832015614559651479520439016757062424577016523463556358066984455332402542345737206229521049493030266829368301746291976943609907055663691491379446563506102162819260353662751063316947194844335784011075059060057648958443191187527894586904520166853889241855199258872026464408485167407295789781647537311358449094940565206190187170103010146898769869153064820412597499183419498527611731140719760318,\"Beta\":1842236524392388004413363649589051135196344297525753833111438010897855410413093181110060727050440600134426211257380627083106678575071413056481657819043028456593757372179569411657666059089225339012202270194986807477435313527136786984376286348859309168239934410838983744773135963549032907967788659225286388093366714461120892086372702989229055826340780102622996079564894334810433574750995664565888225965673964231388730758770331294391500369940729992900609687626347573648112223246540777412969086148539364150238568423017889941252090386268997719310286650600055045520206618383817069645283380471540071618976006086973708783900,\"P\":89076859888329374428834448588875640295464889240139908584166848848489196343609305601818299469095943276512925872046409301814023225882204094799930979950034641671995237955900334121850010220364562220842812167600471148617631238103135231350978395374957884038881516324468027356030819827399246231780905231361459267861,\"Q\":77242417896389752863039920509045963779281716385916611266925798935629449831296516092513287832699841804792146069339631304248414077952739217103112238234257869899831607632499366369552994890774625972620602921438965937336758013127800902501035950942928735490400036839512660670795516140323670591064947868425817928719}"}}' \
      $VAULT_ADDR/v1/tss1/data/keygen_preparams
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"value": "0xb5164b13d2a350f7c9263cb173211ada16c20883d70c449c541dc67ea9e94808"}}' \
      $VAULT_ADDR/v1/tss1/data/core_account
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"value": "{\"PaillierSK\":{\"N\":25222539396214102132947645117922233593416310527922261576767907607209454161148886976687740431574376057717301376863337351866485660948587280403504333047565362634864942355235574974370280655547038889388126778626768745495789937343074376983433409811121185054635688712486168781113695875463482736079503428210169676308334530833939254903788354387280861868113597976139498558860029324728905034236387595729540429364624198142499381828274695128146897507978696565574138170172578682300653201107201844796079327428944058588394275048046535588206168347669132263451197928497591448865056897551369647572951678065293218262773535109517570063301,\"LambdaN\":12611269698107051066473822558961116796708155263961130788383953803604727080574443488343870215787188028858650688431668675933242830474293640201752166523782681317432471177617787487185140327773519444694063389313384372747894968671537188491716704905560592527317844356243084390556847937731741368039751714105084838154008241261454243447796086532479708781524180105490443551208392989750922769260216801420150334439469670438495082035278890685946845471301238500134216100126221853035754326896640128858144179658447569143559718996548863169793669510290518823845159656779366212898942225407056599595021864653058029691480332290256617987206,\"PhiN\":25222539396214102132947645117922233593416310527922261576767907607209454161148886976687740431574376057717301376863337351866485660948587280403504333047565362634864942355235574974370280655547038889388126778626768745495789937343074376983433409811121185054635688712486168781113695875463482736079503428210169676308016482522908486895592173064959417563048360210980887102416785979501845538520433602840300668878939340876990164070557781371893690942602477000268432200252443706071508653793280257716288359316895138287119437993097726339587339020581037647690319313558732425797884450814113199190043729306116059382960664580513235974412,\"P\":150891342892008580658638413715900709146437502755551199099303933791405935401292001882229020130305955511604989879569608191366019320577890618419676337008832733544995506129790473210447006147392030087682387887045119857095508770897363727579142004626039971697874459115593873160254895505626318195353306498612247624027,\"Q\":167156968138759427537542908605543595918800262403060257343939411435653560314661991007010740355378901753904227878147305564887187244798328946886029632911302242684149041184131113869343961964656890213592449167903689391523320556190730888181736610312819051369297987621662575222653053253550840684459564030392086464863},\"NTildei\":27522048145569981576385476070657020085925130726339017105732055245635131139617848779486234236089392739447177029230176776337417792840985410026305811898446122370628457991480751841368787992944674212855827136776106587708211623816096633385470508783942777769060242860553024607789618299480333621903785949269589743855899844781732294719464609693176227125635396506961291206642890240986520873279868204630398583955556159431730110625063162375117211307543187824440584752056647328233594782678897603405275933516376239252164516303232640795307757685973412817046088426802943281427373371681705483044019813362572029248015450975003456793397,\"H1i\":16517568479471580541042167147429887624339112445131695731362812965113271556999931499818506920295872359339618541473632721715590651347747155351693852424406909063273800991740936578905390940693930284712570022696272615200628747778340495713818589656470906148279108801537540281635961498936452198579197181393579833588271971375793237362898722119231386278352366524087073998056530952433549592269901646408479257883589277185145047553119070727427132500779070094700805261739909572847069577770555320557647528931722700347780859584941003633045209132957117021571486230238188597577097341756253345984078902464163897730250825619109443585525,\"H2i\":7009260890983307674042645873443598272360402291874184297628611268334644375502827051885602971774872550746932684397961239936661508751942327338374679890949524040617402859819754169960008995120441085537975312375011245160932483701011029053912892591633122502853519566790980511469316278839843627242914384033499665339269445033918946320801864810354356251335317386995536622835031324684861929125151890912785727964237447305235539333445504406193442566504156368203203389831716945872865325564528075805169478948659002126911172399429651055487198066475747305990261540384572530954665466045817671514939564054758032645426132833343419966435,\"Alpha\":24178785770298028035270144330521408366177012635516436515514285252609396045105742475132287920923959769687003596766445981073304522433616678002914754773901159001959974463126754423168234341647006144447075641205958141510051562440318832015614559651479520439016757062424577016523463556358066984455332402542345737206229521049493030266829368301746291976943609907055663691491379446563506102162819260353662751063316947194844335784011075059060057648958443191187527894586904520166853889241855199258872026464408485167407295789781647537311358449094940565206190187170103010146898769869153064820412597499183419498527611731140719760318,\"Beta\":1842236524392388004413363649589051135196344297525753833111438010897855410413093181110060727050440600134426211257380627083106678575071413056481657819043028456593757372179569411657666059089225339012202270194986807477435313527136786984376286348859309168239934410838983744773135963549032907967788659225286388093366714461120892086372702989229055826340780102622996079564894334810433574750995664565888225965673964231388730758770331294391500369940729992900609687626347573648112223246540777412969086148539364150238568423017889941252090386268997719310286650600055045520206618383817069645283380471540071618976006086973708783900,\"P\":89076859888329374428834448588875640295464889240139908584166848848489196343609305601818299469095943276512925872046409301814023225882204094799930979950034641671995237955900334121850010220364562220842812167600471148617631238103135231350978395374957884038881516324468027356030819827399246231780905231361459267861,\"Q\":77242417896389752863039920509045963779281716385916611266925798935629449831296516092513287832699841804792146069339631304248414077952739217103112238234257869899831607632499366369552994890774625972620602921438965937336758013127800902501035950942928735490400036839512660670795516140323670591064947868425817928719,\"Xi\":25998402361925723478150605139640451203663612449671419518422562239379520160397,\"ShareID\":625664809357144621199213330413524971235421323270,\"Ks\":[625664809357144621199213330413524971235421323270,766418774313531105623098104317968735865501209001,916059140686050998083978944447064389845990912875],\"NTildej\":[27522048145569981576385476070657020085925130726339017105732055245635131139617848779486234236089392739447177029230176776337417792840985410026305811898446122370628457991480751841368787992944674212855827136776106587708211623816096633385470508783942777769060242860553024607789618299480333621903785949269589743855899844781732294719464609693176227125635396506961291206642890240986520873279868204630398583955556159431730110625063162375117211307543187824440584752056647328233594782678897603405275933516376239252164516303232640795307757685973412817046088426802943281427373371681705483044019813362572029248015450975003456793397,26287095469882602259502960253155254360804319664057270189400555438054357337039614490548038307454671193615535895363160165395716478102599420425673849627176549512756025903516156113017789809445854157445538189888630423465309197773535791949509398585263047625717743386222018827777580573693980777100354534528660867076047014926437366102709599305753278778933593961568721564772996025784590013410301807035352087426157394490518039676044525664902377430194383257189430440590876636954585590235337308078794409472039895617243643395811418712000686126844715347501087676349248362549061632812724867306834763198717465818908662935792809313461,23480415588435419031447079673342707638584619157635925492892092700956060545054581211317334723150904861647190443363724915913333634731042690202334969095297558918226065644052149284231228609885061347987303336592232342077541836117562828680125795146950913810227400817925439088111347951718821237533712931454939571041465013966764098136630139098758185943869375547993588616403453940445655380460537844392425662492015903802136973858968487213723069854403978084196943365237107277679727406895299211293901166051965782637942434024652916212091234932440173565058930379352547491346302287905973361117574863852150429835457489028946773862121],\"H1j\":[16517568479471580541042167147429887624339112445131695731362812965113271556999931499818506920295872359339618541473632721715590651347747155351693852424406909063273800991740936578905390940693930284712570022696272615200628747778340495713818589656470906148279108801537540281635961498936452198579197181393579833588271971375793237362898722119231386278352366524087073998056530952433549592269901646408479257883589277185145047553119070727427132500779070094700805261739909572847069577770555320557647528931722700347780859584941003633045209132957117021571486230238188597577097341756253345984078902464163897730250825619109443585525,7237296850102268809994391546422806771347421159582956353244469392173556245485887457113471982438691859952586948054041931864327489311127741289168937238696227543427161114005626119761194204840161333289011028101857213468065152804524954246351365273946276689599882908377802458781536966578763817065593945744764572690228246297840801885643084377214499585041076814427271051646943709207624302771267224258220858975367390613934384286047461793500454991574228495571945567704822616857994598586850247654535280319590421886683662233275827643945568263492469168667896177789512153268054577266692088605275176858300251672907083732758224300605,5244625320890758926823236807577436724284838598713053894859482410751817243781879176481630696209928554813580388949933383265760121927355967924125199634578244258322548509081654208382874250887126067143103657480563891927357049788066150009272405448366743698886019402037370394519945482107092906983297562458511070353876474628171257852523538903349915748196522993465048339465501002966487352363881955493353463137731082045334297957366902605993954637756964170953811640782160016128220626751514742583329029928572309497541088770781393935677741525856476779288748073006775582646889485680084355364188574749761390046121904185116946045566],\"H2j\":[7009260890983307674042645873443598272360402291874184297628611268334644375502827051885602971774872550746932684397961239936661508751942327338374679890949524040617402859819754169960008995120441085537975312375011245160932483701011029053912892591633122502853519566790980511469316278839843627242914384033499665339269445033918946320801864810354356251335317386995536622835031324684861929125151890912785727964237447305235539333445504406193442566504156368203203389831716945872865325564528075805169478948659002126911172399429651055487198066475747305990261540384572530954665466045817671514939564054758032645426132833343419966435,18466749817946044150553924616420387687206097203280195091736108793324688078484955636193932153729736892592854146381201326144829913584998765092920657820383019994011038791187893733125656289003473873902534439014371112885776632378339360078278137714330073530807181523557193669920350571316763823451053180616837192996398055144521752057518902938931133591279480112693018857707713794810315766346454595609625905047554072392064316910915940533310037364560325306800203727643345507302326279358384562465006827568506035523943913412901074793452573117887015063684946946486775965102910635992776743190835788384535879618002669142951088681822,14594346189095736747225884320665122466781709130296311799936140821845005707361969481771237336943241045846198194729530707984812596096197073779339845516025127003079087887760214159407509566512887375945758017191971067305459350608195289978927459042719267798647279892469529011521861358583760223133316545691872222500422769804045468217338943573175507344490987948897073607894657847841365159409323996140440196447829619732543872240361901392265668680831787448636887349391368628269910852040117529969597030556767165164122605145506454531225988854626670635330962899644382358608473267918441558783891780673214920504774987530770981704584],\"BigXj\":[{\"Curve\":\"secp256k1\",\"Coords\":[10595438597909221693748036930367535218954356641874811938509902668063892235679,40877866135104242373591861551464362310945480182503735785144669068942966547117]},{\"Curve\":\"secp256k1\",\"Coords\":[92793207823966202621751812820284297718761291093278899871726971928177640206077,92297913991377303798846750922249149640778764243812796171685353631556413999938]},{\"Curve\":\"secp256k1\",\"Coords\":[55900868197020429748489726670781890551991126161281129422810864018199515922765,25896859200074660682091578664718358181824979392968560255507974651069732695971]}],\"PaillierPKs\":[{\"N\":25222539396214102132947645117922233593416310527922261576767907607209454161148886976687740431574376057717301376863337351866485660948587280403504333047565362634864942355235574974370280655547038889388126778626768745495789937343074376983433409811121185054635688712486168781113695875463482736079503428210169676308334530833939254903788354387280861868113597976139498558860029324728905034236387595729540429364624198142499381828274695128146897507978696565574138170172578682300653201107201844796079327428944058588394275048046535588206168347669132263451197928497591448865056897551369647572951678065293218262773535109517570063301},{\"N\":26795283137702680682928249296862530087842472246734793136745425103959797131946275785165380123246407347541301756608534399417315457621297828173799100415299038028000132400007033145208285975357270757349676475802290506334022575819711909048726984191229330686488645692766575512700815350477138871118264629456261245575818169248652012556458657614846527785238918007798503573524329415425634909433966472098690759475157567990295040713842313089421340490759563136309803284566724929689553851247027199218315480217785342029301299800845267212726702659481781642485092085828482087529504439014735616242894754686134401726498504177961361934173},{\"N\":23949789292911593449510090425353172637070236362229751109169870170660074497909172961293310462873907002932545468074300537494304277845207045851997549356787128175383049248182587416414995106526129859920221044303102714478973195782211467295196796329468913412347036581448101530025176782014110769308326049264044433721591396377444569703626747403360277212347996478898918531541102343860198874119847987688888682820636176591093459578593615102261280505750205171369244044064814235203973794638759615390042916863073533489259278661362761417186511175522276964580366578308875060521309515076941359221298299863412994866078466202574042667573}],\"ECDSAPub\":{\"Curve\":\"secp256k1\",\"Coords\":[54395761864595184025289438248194755919131038527475290364574472112973735884319,19002356526498140446852353712213625197381438986713448406980976582657340900049]}}"}}' \
      $VAULT_ADDR/v1/tss1/data/tss_share
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"cert_data": "-----BEGIN CERTIFICATE-----\r\nMIIDHDCCAgSgAwIBAgIUeUkfq6PQjMQFgRZU+PYXnNuZYkcwDQYJKoZIhvcNAQEL\r\nBQAwEjEQMA4GA1UEAwwHcGFydHktMTAeFw0yNTAzMTkxNzMyNDZaFw0yNjAzMTkx\r\nNzMyNDZaMBIxEDAOBgNVBAMMB3BhcnR5LTEwggEiMA0GCSqGSIb3DQEBAQUAA4IB\r\nDwAwggEKAoIBAQDJ4TIH7Q2uU\/CpYRNOJAf0mXoOnpdLF+18rB1I+1+lp8CzwGue\r\ns6I2wF5ngFz4g4LKyHyU5ry5FKKBT9vHXslN36SAOA8\/Pg6vf4kDrEBUnYzUCG7D\r\ndMKQGxTGo7E0p1HWwaXSg1EdfX5mK3iWnj5FmdyR3qFja8XxHW+UKNrRzwJGMt2W\r\nUxA2eQ9uWgPjPdr2mwfvaWswOIRxEW9DJvfj1QUjgOVcSPQZDKwVoP6p\/6tEvCJc\r\nMnengEyFQ7Y59GKVR88Tx1kgnplxB2gP0MSlxNMzmjKLxbtfTt7sarDK+ZHmo\/mT\r\nGYTSSYhqYA0ElrvYw21emCXhrYP49RrwA6aTAgMBAAGjajBoMBAGA1UdEQQJMAeC\r\nBXRzcy0xMAkGA1UdEwQCMAAwCwYDVR0PBAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUF\r\nBwMBBggrBgEFBQcDAjAdBgNVHQ4EFgQU+xdAMXnOHBaxXLQ+85w59bSzzJ0wDQYJ\r\nKoZIhvcNAQELBQADggEBAIzZxaKPYBdZUes04XSWUBvxXLI2urCx\/cOYkqxPHksU\r\nOGqfbjDgA0RFXg7H5ICS1Ybn3tWbkFxZHgsNAqLL0V6A4x\/yR9TEbyPQcaOFjcL+\r\nZfxQ08fjQ18DChNWte\/wlsLbipfpivvs7q0kEST32828BuqVVV3T7zET70Lhw3YJ\r\nXMpQT0FyaOpgq7957QjOKRmseFInkZ\/lVN312EuvUKTZLMbOHDDjb598dcBw9OkP\r\n+GJtzepSgcv+jjUApzzFobEEWbkXBNYmQlPYmIGrWL\/wLmswrxhgAfArzw2qIPvU\r\nhY6YRnQYz+4rcwl5EhsgxjOZ+AsoLF46PwMXtbyfCnU=\r\n-----END CERTIFICATE-----\r\n","key_data":"-----BEGIN PRIVATE KEY-----\r\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDJ4TIH7Q2uU\/Cp\r\nYRNOJAf0mXoOnpdLF+18rB1I+1+lp8CzwGues6I2wF5ngFz4g4LKyHyU5ry5FKKB\r\nT9vHXslN36SAOA8\/Pg6vf4kDrEBUnYzUCG7DdMKQGxTGo7E0p1HWwaXSg1EdfX5m\r\nK3iWnj5FmdyR3qFja8XxHW+UKNrRzwJGMt2WUxA2eQ9uWgPjPdr2mwfvaWswOIRx\r\nEW9DJvfj1QUjgOVcSPQZDKwVoP6p\/6tEvCJcMnengEyFQ7Y59GKVR88Tx1kgnplx\r\nB2gP0MSlxNMzmjKLxbtfTt7sarDK+ZHmo\/mTGYTSSYhqYA0ElrvYw21emCXhrYP4\r\n9RrwA6aTAgMBAAECggEARkRO4LlfCK2I17vFN26NIlMFS+9hY67ZZ4qUyuFL4mHo\r\nTeiMzPljXcFJWqcwNQO5U5HC4yUIzTbkdTPxoIxabvOH02Uv0WhtPiKa8x9SaOFJ\r\nskeZHgkW64exjI5PUK9oaeKPMB2q7yPOCgvZdjtwG1O5lUAzVmKdzBXdz2kE+P+A\r\nYy523zpIpreu6WeIi8Xxra8jd5iaHYK+RYjSA\/D8YGDa+0\/QB7NxkWt\/MmMvDQqT\r\n8JBoDqEGEoWWB5+l3yPJT0hu0AGvphGnsAQ19fDSrfCq\/4TrZkqq0QriIkBloxW6\r\nSC6Xzu4451shNwZqQoeuGSBZFzHv9pJ8JD9rnpbp2QKBgQD+HBSntUZSdQ\/Syvkq\r\nakX5zPDNOzEk\/cRdt+UofU0nrGK2bYbjzPWscndRdcJIaj\/u7fDT6fXJf5iNKXL8\r\n5ORrFSG5XDm8rrUbA6MKEwR5BwX2Ce4yWr3Jc1mut12VtUGoPDRJlCAlnV58WMDA\r\nXI2BhXN2KzA5xJiAg8JQITQtnQKBgQDLYaY9W1o\/Cl2l5P4AO23QOIDcZEqSBB3w\r\n9rSroi9qi+T3Hbt7GHA7N7EOSg6pUWgH5ktcdoMPmJiFRJDLTVhTT\/Ypu7jvNv1f\r\nNaZ4BbjzqNpwTQkPVvldlXq2pzO8RTsleOl\/kHm6Lqqwpbh3+fksIYYOb9QSwjrK\r\nzDCsMT0F7wKBgFZ79ieyEZIE13LVtAHUk6ZWMuqWp75ARDHlYa\/rHXRQPnR6SHuF\r\niWO8vZFS8+Gzj7jg8KMfMJD4xVHd9o3N1VQAqC6vDdOC3o6oKThHirEqS8QWUyR+\r\nL7O9d5t4Ovi17Pe2LdGRAXPr4HmPt2KA3YRkiAyC3HH80C6FKYAeHOUdAoGBAJUP\r\np8i2iKlFjqeE8wj2haCjmQZu1xy3ub4fAwH8Z6Y+i\/z2JK+ulKtCQRmI+7\/rM0T+\r\n6+MD1UD8BWU\/gKQQtxiwtWmW9Y8WDZPXfX\/gKdMjwZ2nSGmexDtr0DnIyClH0HbB\r\nbNma6SylAWNgwpfkdVR76YXxPkzVYEO8bjv2BpSvAoGBAMzvJhenoU94bpWeqvlk\r\ns31pvCHIHeV8+WK4gbsM88oSHZ1AOvRnmjaTsjVTlrLSUAFh5Vxo3k1HJjbpBidx\r\nwl7dgm\/teixv0RiS1BuBQJviTAdCmSZDir6rsTsnpNG4z1Rpu\/gX4aFvnySJcpDf\r\nLUZLfmb6pXd9TD7sYCNBfQys\r\n-----END PRIVATE KEY-----\r\n"}}' \
      $VAULT_ADDR/v1/tss1/data/tls_cert

  echo "Initializing TSS 2"
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"value": "{\"PaillierSK\":{\"N\":23949789292911593449510090425353172637070236362229751109169870170660074497909172961293310462873907002932545468074300537494304277845207045851997549356787128175383049248182587416414995106526129859920221044303102714478973195782211467295196796329468913412347036581448101530025176782014110769308326049264044433721591396377444569703626747403360277212347996478898918531541102343860198874119847987688888682820636176591093459578593615102261280505750205171369244044064814235203973794638759615390042916863073533489259278661362761417186511175522276964580366578308875060521309515076941359221298299863412994866078466202574042667573,\"LambdaN\":11974894646455796724755045212676586318535118181114875554584935085330037248954586480646655231436953501466272734037150268747152138922603522925998774678393564087691524624091293708207497553263064929960110522151551357239486597891105733647598398164734456706173518290724050765012588391007055384654163024632022216860640375798469880021536709557370577531772605109802353837479036021355748635699623455126267477588298425618567721274907913910908206434057292159869358240001078718226970146110646168083467233604175888466358753786198037231485227005500896725985164812282223808759546236941554880316003779704474822145334032125669227451494,\"PhiN\":23949789292911593449510090425353172637070236362229751109169870170660074497909172961293310462873907002932545468074300537494304277845207045851997549356787128175383049248182587416414995106526129859920221044303102714478973195782211467295196796329468913412347036581448101530025176782014110769308326049264044433721280751596939760043073419114741155063545210219604707674958072042711497271399246910252534955176596851237135442549815827821816412868114584319738716480002157436453940292221292336166934467208351776932717507572396074462970454011001793451970329624564447617519092473883109760632007559408949644290668064251338454902988,\"P\":168560804840592857953719124685092323950596591827625840277116650955044449708082732493489499923000606142729459918349646171582569792400403724617067865315330370214293803720727248222045544552572234240354310156346385692167371629919101722093488489006240398339626256337539770488433172870498142592029493065420761439619,\"Q\":142083975664216802599609163934029824852189667466585016305913650193657153012518344942864227721038719211228557110428141108862297845235217127013459698747326428535739698696740031001062905102149522316187460932620301262048685534601381790516548464738187044662590784856291828100857567583965207983380908885814826324967},\"NTildei\":23480415588435419031447079673342707638584619157635925492892092700956060545054581211317334723150904861647190443363724915913333634731042690202334969095297558918226065644052149284231228609885061347987303336592232342077541836117562828680125795146950913810227400817925439088111347951718821237533712931454939571041465013966764098136630139098758185943869375547993588616403453940445655380460537844392425662492015903802136973858968487213723069854403978084196943365237107277679727406895299211293901166051965782637942434024652916212091234932440173565058930379352547491346302287905973361117574863852150429835457489028946773862121,\"H1i\":5244625320890758926823236807577436724284838598713053894859482410751817243781879176481630696209928554813580388949933383265760121927355967924125199634578244258322548509081654208382874250887126067143103657480563891927357049788066150009272405448366743698886019402037370394519945482107092906983297562458511070353876474628171257852523538903349915748196522993465048339465501002966487352363881955493353463137731082045334297957366902605993954637756964170953811640782160016128220626751514742583329029928572309497541088770781393935677741525856476779288748073006775582646889485680084355364188574749761390046121904185116946045566,\"H2i\":14594346189095736747225884320665122466781709130296311799936140821845005707361969481771237336943241045846198194729530707984812596096197073779339845516025127003079087887760214159407509566512887375945758017191971067305459350608195289978927459042719267798647279892469529011521861358583760223133316545691872222500422769804045468217338943573175507344490987948897073607894657847841365159409323996140440196447829619732543872240361901392265668680831787448636887349391368628269910852040117529969597030556767165164122605145506454531225988854626670635330962899644382358608473267918441558783891780673214920504774987530770981704584,\"Alpha\":6849983899908839477446998981271744131325933529361571379418451316019981099335941018518872987098502545962210870285503466367236879379209835752622677240651847718148117782387557464941434343925340801690677827581243802202946029540882876148000789639310391232737175161153075193019087999995147840909112332932280345611684468595457782464460012011322167149066634383990122923438020021762489430848065292983874560611609056796134683497065218638164221506590753226536180358476214587409097579919853414736261669827341453686633517790118462010193065857873294119204591197936034415903929634546488536969308434620828170998975102411271908214450,\"Beta\":1335317112228187012591681633442315367076981402840725450256237355568443173067494686168575636615076475141387704560827215691780873780662116193990070171694314830127802717424694200486654488271460368390517751669243686049458502219836904297161887286444962050038730391886622568450873488545477563988132701170614994640401751652463407314316335905982645228286655962364559818918235324007659340176539997919714600985052059264364958857910249925345901254750798838349798938669280266482223976992744989435431891908101120310882759132822746224526244112340431949502423172601416858812968802104428574789717207603578958034192161020268395416556,\"P\":83205697366475707013272346458674560365964365948115580285063179406342662400228561778451021899715257517907197349419122670471046127419099529787196293112006144475901286703945889555737056213901995301964611616530315128697750145112153074320158894529162914984987799670774533069477396780252038616443269828729010160559,\"Q\":70549302306238109103155203324449977009957538047214854708176090947231122565831982440113126824918804906763755255072248524573563857706924566100524941234591720361019965188029453346046328692368145167725445181500697792323656923879765810345696113423994753776212138069069651771852988582222162236432391647424787205979}"}}' \
      $VAULT_ADDR/v1/tss2/data/keygen_preparams
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"value": "0x78e99c7e010ad161fb8aaace13528e272e17edbf50693ed146bf222727b57905"}}' \
      $VAULT_ADDR/v1/tss2/data/core_account
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"value": "{\"PaillierSK\":{\"N\":23949789292911593449510090425353172637070236362229751109169870170660074497909172961293310462873907002932545468074300537494304277845207045851997549356787128175383049248182587416414995106526129859920221044303102714478973195782211467295196796329468913412347036581448101530025176782014110769308326049264044433721591396377444569703626747403360277212347996478898918531541102343860198874119847987688888682820636176591093459578593615102261280505750205171369244044064814235203973794638759615390042916863073533489259278661362761417186511175522276964580366578308875060521309515076941359221298299863412994866078466202574042667573,\"LambdaN\":11974894646455796724755045212676586318535118181114875554584935085330037248954586480646655231436953501466272734037150268747152138922603522925998774678393564087691524624091293708207497553263064929960110522151551357239486597891105733647598398164734456706173518290724050765012588391007055384654163024632022216860640375798469880021536709557370577531772605109802353837479036021355748635699623455126267477588298425618567721274907913910908206434057292159869358240001078718226970146110646168083467233604175888466358753786198037231485227005500896725985164812282223808759546236941554880316003779704474822145334032125669227451494,\"PhiN\":23949789292911593449510090425353172637070236362229751109169870170660074497909172961293310462873907002932545468074300537494304277845207045851997549356787128175383049248182587416414995106526129859920221044303102714478973195782211467295196796329468913412347036581448101530025176782014110769308326049264044433721280751596939760043073419114741155063545210219604707674958072042711497271399246910252534955176596851237135442549815827821816412868114584319738716480002157436453940292221292336166934467208351776932717507572396074462970454011001793451970329624564447617519092473883109760632007559408949644290668064251338454902988,\"P\":168560804840592857953719124685092323950596591827625840277116650955044449708082732493489499923000606142729459918349646171582569792400403724617067865315330370214293803720727248222045544552572234240354310156346385692167371629919101722093488489006240398339626256337539770488433172870498142592029493065420761439619,\"Q\":142083975664216802599609163934029824852189667466585016305913650193657153012518344942864227721038719211228557110428141108862297845235217127013459698747326428535739698696740031001062905102149522316187460932620301262048685534601381790516548464738187044662590784856291828100857567583965207983380908885814826324967},\"NTildei\":23480415588435419031447079673342707638584619157635925492892092700956060545054581211317334723150904861647190443363724915913333634731042690202334969095297558918226065644052149284231228609885061347987303336592232342077541836117562828680125795146950913810227400817925439088111347951718821237533712931454939571041465013966764098136630139098758185943869375547993588616403453940445655380460537844392425662492015903802136973858968487213723069854403978084196943365237107277679727406895299211293901166051965782637942434024652916212091234932440173565058930379352547491346302287905973361117574863852150429835457489028946773862121,\"H1i\":5244625320890758926823236807577436724284838598713053894859482410751817243781879176481630696209928554813580388949933383265760121927355967924125199634578244258322548509081654208382874250887126067143103657480563891927357049788066150009272405448366743698886019402037370394519945482107092906983297562458511070353876474628171257852523538903349915748196522993465048339465501002966487352363881955493353463137731082045334297957366902605993954637756964170953811640782160016128220626751514742583329029928572309497541088770781393935677741525856476779288748073006775582646889485680084355364188574749761390046121904185116946045566,\"H2i\":14594346189095736747225884320665122466781709130296311799936140821845005707361969481771237336943241045846198194729530707984812596096197073779339845516025127003079087887760214159407509566512887375945758017191971067305459350608195289978927459042719267798647279892469529011521861358583760223133316545691872222500422769804045468217338943573175507344490987948897073607894657847841365159409323996140440196447829619732543872240361901392265668680831787448636887349391368628269910852040117529969597030556767165164122605145506454531225988854626670635330962899644382358608473267918441558783891780673214920504774987530770981704584,\"Alpha\":6849983899908839477446998981271744131325933529361571379418451316019981099335941018518872987098502545962210870285503466367236879379209835752622677240651847718148117782387557464941434343925340801690677827581243802202946029540882876148000789639310391232737175161153075193019087999995147840909112332932280345611684468595457782464460012011322167149066634383990122923438020021762489430848065292983874560611609056796134683497065218638164221506590753226536180358476214587409097579919853414736261669827341453686633517790118462010193065857873294119204591197936034415903929634546488536969308434620828170998975102411271908214450,\"Beta\":1335317112228187012591681633442315367076981402840725450256237355568443173067494686168575636615076475141387704560827215691780873780662116193990070171694314830127802717424694200486654488271460368390517751669243686049458502219836904297161887286444962050038730391886622568450873488545477563988132701170614994640401751652463407314316335905982645228286655962364559818918235324007659340176539997919714600985052059264364958857910249925345901254750798838349798938669280266482223976992744989435431891908101120310882759132822746224526244112340431949502423172601416858812968802104428574789717207603578958034192161020268395416556,\"P\":83205697366475707013272346458674560365964365948115580285063179406342662400228561778451021899715257517907197349419122670471046127419099529787196293112006144475901286703945889555737056213901995301964611616530315128697750145112153074320158894529162914984987799670774533069477396780252038616443269828729010160559,\"Q\":70549302306238109103155203324449977009957538047214854708176090947231122565831982440113126824918804906763755255072248524573563857706924566100524941234591720361019965188029453346046328692368145167725445181500697792323656923879765810345696113423994753776212138069069651771852988582222162236432391647424787205979,\"Xi\":107189717688059678422030089933917155221914008072826145993878461410353995472969,\"ShareID\":916059140686050998083978944447064389845990912875,\"Ks\":[625664809357144621199213330413524971235421323270,766418774313531105623098104317968735865501209001,916059140686050998083978944447064389845990912875],\"NTildej\":[27522048145569981576385476070657020085925130726339017105732055245635131139617848779486234236089392739447177029230176776337417792840985410026305811898446122370628457991480751841368787992944674212855827136776106587708211623816096633385470508783942777769060242860553024607789618299480333621903785949269589743855899844781732294719464609693176227125635396506961291206642890240986520873279868204630398583955556159431730110625063162375117211307543187824440584752056647328233594782678897603405275933516376239252164516303232640795307757685973412817046088426802943281427373371681705483044019813362572029248015450975003456793397,26287095469882602259502960253155254360804319664057270189400555438054357337039614490548038307454671193615535895363160165395716478102599420425673849627176549512756025903516156113017789809445854157445538189888630423465309197773535791949509398585263047625717743386222018827777580573693980777100354534528660867076047014926437366102709599305753278778933593961568721564772996025784590013410301807035352087426157394490518039676044525664902377430194383257189430440590876636954585590235337308078794409472039895617243643395811418712000686126844715347501087676349248362549061632812724867306834763198717465818908662935792809313461,23480415588435419031447079673342707638584619157635925492892092700956060545054581211317334723150904861647190443363724915913333634731042690202334969095297558918226065644052149284231228609885061347987303336592232342077541836117562828680125795146950913810227400817925439088111347951718821237533712931454939571041465013966764098136630139098758185943869375547993588616403453940445655380460537844392425662492015903802136973858968487213723069854403978084196943365237107277679727406895299211293901166051965782637942434024652916212091234932440173565058930379352547491346302287905973361117574863852150429835457489028946773862121],\"H1j\":[16517568479471580541042167147429887624339112445131695731362812965113271556999931499818506920295872359339618541473632721715590651347747155351693852424406909063273800991740936578905390940693930284712570022696272615200628747778340495713818589656470906148279108801537540281635961498936452198579197181393579833588271971375793237362898722119231386278352366524087073998056530952433549592269901646408479257883589277185145047553119070727427132500779070094700805261739909572847069577770555320557647528931722700347780859584941003633045209132957117021571486230238188597577097341756253345984078902464163897730250825619109443585525,7237296850102268809994391546422806771347421159582956353244469392173556245485887457113471982438691859952586948054041931864327489311127741289168937238696227543427161114005626119761194204840161333289011028101857213468065152804524954246351365273946276689599882908377802458781536966578763817065593945744764572690228246297840801885643084377214499585041076814427271051646943709207624302771267224258220858975367390613934384286047461793500454991574228495571945567704822616857994598586850247654535280319590421886683662233275827643945568263492469168667896177789512153268054577266692088605275176858300251672907083732758224300605,5244625320890758926823236807577436724284838598713053894859482410751817243781879176481630696209928554813580388949933383265760121927355967924125199634578244258322548509081654208382874250887126067143103657480563891927357049788066150009272405448366743698886019402037370394519945482107092906983297562458511070353876474628171257852523538903349915748196522993465048339465501002966487352363881955493353463137731082045334297957366902605993954637756964170953811640782160016128220626751514742583329029928572309497541088770781393935677741525856476779288748073006775582646889485680084355364188574749761390046121904185116946045566],\"H2j\":[7009260890983307674042645873443598272360402291874184297628611268334644375502827051885602971774872550746932684397961239936661508751942327338374679890949524040617402859819754169960008995120441085537975312375011245160932483701011029053912892591633122502853519566790980511469316278839843627242914384033499665339269445033918946320801864810354356251335317386995536622835031324684861929125151890912785727964237447305235539333445504406193442566504156368203203389831716945872865325564528075805169478948659002126911172399429651055487198066475747305990261540384572530954665466045817671514939564054758032645426132833343419966435,18466749817946044150553924616420387687206097203280195091736108793324688078484955636193932153729736892592854146381201326144829913584998765092920657820383019994011038791187893733125656289003473873902534439014371112885776632378339360078278137714330073530807181523557193669920350571316763823451053180616837192996398055144521752057518902938931133591279480112693018857707713794810315766346454595609625905047554072392064316910915940533310037364560325306800203727643345507302326279358384562465006827568506035523943913412901074793452573117887015063684946946486775965102910635992776743190835788384535879618002669142951088681822,14594346189095736747225884320665122466781709130296311799936140821845005707361969481771237336943241045846198194729530707984812596096197073779339845516025127003079087887760214159407509566512887375945758017191971067305459350608195289978927459042719267798647279892469529011521861358583760223133316545691872222500422769804045468217338943573175507344490987948897073607894657847841365159409323996140440196447829619732543872240361901392265668680831787448636887349391368628269910852040117529969597030556767165164122605145506454531225988854626670635330962899644382358608473267918441558783891780673214920504774987530770981704584],\"BigXj\":[{\"Curve\":\"secp256k1\",\"Coords\":[10595438597909221693748036930367535218954356641874811938509902668063892235679,40877866135104242373591861551464362310945480182503735785144669068942966547117]},{\"Curve\":\"secp256k1\",\"Coords\":[92793207823966202621751812820284297718761291093278899871726971928177640206077,92297913991377303798846750922249149640778764243812796171685353631556413999938]},{\"Curve\":\"secp256k1\",\"Coords\":[55900868197020429748489726670781890551991126161281129422810864018199515922765,25896859200074660682091578664718358181824979392968560255507974651069732695971]}],\"PaillierPKs\":[{\"N\":25222539396214102132947645117922233593416310527922261576767907607209454161148886976687740431574376057717301376863337351866485660948587280403504333047565362634864942355235574974370280655547038889388126778626768745495789937343074376983433409811121185054635688712486168781113695875463482736079503428210169676308334530833939254903788354387280861868113597976139498558860029324728905034236387595729540429364624198142499381828274695128146897507978696565574138170172578682300653201107201844796079327428944058588394275048046535588206168347669132263451197928497591448865056897551369647572951678065293218262773535109517570063301},{\"N\":26795283137702680682928249296862530087842472246734793136745425103959797131946275785165380123246407347541301756608534399417315457621297828173799100415299038028000132400007033145208285975357270757349676475802290506334022575819711909048726984191229330686488645692766575512700815350477138871118264629456261245575818169248652012556458657614846527785238918007798503573524329415425634909433966472098690759475157567990295040713842313089421340490759563136309803284566724929689553851247027199218315480217785342029301299800845267212726702659481781642485092085828482087529504439014735616242894754686134401726498504177961361934173},{\"N\":23949789292911593449510090425353172637070236362229751109169870170660074497909172961293310462873907002932545468074300537494304277845207045851997549356787128175383049248182587416414995106526129859920221044303102714478973195782211467295196796329468913412347036581448101530025176782014110769308326049264044433721591396377444569703626747403360277212347996478898918531541102343860198874119847987688888682820636176591093459578593615102261280505750205171369244044064814235203973794638759615390042916863073533489259278661362761417186511175522276964580366578308875060521309515076941359221298299863412994866078466202574042667573}],\"ECDSAPub\":{\"Curve\":\"secp256k1\",\"Coords\":[54395761864595184025289438248194755919131038527475290364574472112973735884319,19002356526498140446852353712213625197381438986713448406980976582657340900049]}}"}}' \
      $VAULT_ADDR/v1/tss2/data/tss_share
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"cert_data": "-----BEGIN CERTIFICATE-----\r\nMIIDHDCCAgSgAwIBAgIUPUc+mp7snHxEwonExkyT2YGkYqwwDQYJKoZIhvcNAQEL\r\nBQAwEjEQMA4GA1UEAwwHcGFydHktMjAeFw0yNTAzMTkxNzMyNDdaFw0yNjAzMTkx\r\nNzMyNDdaMBIxEDAOBgNVBAMMB3BhcnR5LTIwggEiMA0GCSqGSIb3DQEBAQUAA4IB\r\nDwAwggEKAoIBAQCJnZ4YMwMlDI9g9Jtt+bZqWSQ8RhQszefwP\/tM9h8buIo32HzU\r\nECWtmWX4ztpGGpiKfeEq\/5vNSCfz\/iUaOVBp7vOyIVBrqh6QlyjU3C+y4kzUM0rN\r\nhiiejnNfg2G0ERQwDWvkN8etiZwOtjhqdhJPPkf7VAQqL4dgjtgyW4TJK62PKg3D\r\njuELRpHshSp0nLUvXzoFUkaydbUVfc4NPy2\/5jbB\/royWL3X2A2C7Q28BWFiRYCw\r\n9k9CJ3RLVC9wjur5O2fcROPPHgsp0Q4GSCQDyFx3t312jTo12Bcf9HuqHa20VwQv\r\nXsAUWpSmppVHLUxyXDs1HZgFTRXgDKspbdshAgMBAAGjajBoMBAGA1UdEQQJMAeC\r\nBXRzcy0yMAkGA1UdEwQCMAAwCwYDVR0PBAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUF\r\nBwMBBggrBgEFBQcDAjAdBgNVHQ4EFgQUQlfKDKFjX6XRCa\/P8Ak+zxZb2eYwDQYJ\r\nKoZIhvcNAQELBQADggEBAA5uPxOX\/g\/Tcunej2JVmpm+8xvnQ5LslV3jzS79hk7N\r\nht+CTgVK2UfPSVadD7ypgAhBDdrsoH92ki7ibbYrAWUQUH0KcGTJR9wLEWBZXjAG\r\nxq5+Cl2pvYRL\/ooqR8JLGNNQ8uWijCqng7PlxVta\/oEfflNcDb1RCME4tHkWgYmA\r\n7AH2AtxYkSvHll4oALGDvlrE3FeQYOMrZdf3bTKRvm3w3nAd\/J05UCk7ca8llif2\r\nLclLPPeTmT66pI4bMGL4pSTthqCfaOkYnBNkW\/V+DploK9CwgCmcae9xYqQhRFr9\r\n8fVuFrTJGKTieP6PqRNKPqv5dkX9azrSRY7GPWYkH2U=\r\n-----END CERTIFICATE-----\r\n","key_data":"-----BEGIN PRIVATE KEY-----\r\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCJnZ4YMwMlDI9g\r\n9Jtt+bZqWSQ8RhQszefwP\/tM9h8buIo32HzUECWtmWX4ztpGGpiKfeEq\/5vNSCfz\r\n\/iUaOVBp7vOyIVBrqh6QlyjU3C+y4kzUM0rNhiiejnNfg2G0ERQwDWvkN8etiZwO\r\ntjhqdhJPPkf7VAQqL4dgjtgyW4TJK62PKg3DjuELRpHshSp0nLUvXzoFUkaydbUV\r\nfc4NPy2\/5jbB\/royWL3X2A2C7Q28BWFiRYCw9k9CJ3RLVC9wjur5O2fcROPPHgsp\r\n0Q4GSCQDyFx3t312jTo12Bcf9HuqHa20VwQvXsAUWpSmppVHLUxyXDs1HZgFTRXg\r\nDKspbdshAgMBAAECggEAFRponglkmA\/fBN094JWElbZpyhxtB5nj0YHeRaUQjC22\r\ndG3sZpC7Vm3Jp2gBLPLzJXm8R92+xLIl\/lKg2e6kGDqegFh\/fqMt4Lptdob1gZcW\r\ndQwQkofaPsZVhvYcy4I6+Et2mh67ri8GEXN8H0dP83r3iuENanKzbek52i8So86n\r\nStyanT9t4sNd1S4WH0YHeeTv0nqP8bsqfhqcrRD0fsOEfscEgI58RK3g4m62UBjf\r\n4tJzpZrFNrejwGZufZdkCXX0sVetxvK61rhvIfSfeBNLG3tDCZyRyeaDOqt2Bp4W\r\noYlzvSBpQ\/VbG3mVOb5ZauE3oybi74HKvv68DmyxKQKBgQDCX7DVFxjDWUN8J7y\/\r\nNABOuR0y\/p8KCSAnLjPlDf1gQwB42FpyENPuJqUAcfYJ4FC3x2ngmzOJHGFGLhjE\r\nsUtFySU7Ql1XyImup0PW0bkX2691xIiDFumMY+agvuD1PBvCY7egjI1Wty37zjED\r\nAGfd3JoXh0pdlbkD4Dl1\/AjJywKBgQC1PyrUd9V06KT5U8nP78HGZNL5VjdGvbwn\r\nAzrCcJGYGrm+dy4baW2pP\/HAFH2K5L5kvBDM3U2HMTcQGz2Vvo3Uv8CiGU8kId+P\r\n4HZYT0+vrFTvfmURlRdKAZ7M57UBAIXwAu3P+1tpju6Ryz8x57fZ2CzBMUAlo+Fz\r\nIcSPRR3BQwKBgHZnOB72TN1i2NsekbmfgbhyxzizJkpEuNNlL7OOTBSBfB4hHSdy\r\n3Marv8N\/qDLn9AOfc\/2gTUpugUrw9aGLpqDCIO3yRU4eGNDNj2Oiqa\/A4SdKKyY\/\r\npNEiYfD1la+NiBNoDwm71LVILLjBJ9X+P0dFBJDklwZfGC8mPZqDhw71AoGAfP7E\r\nPeUq28Z5x80mF\/ZET9tGuFfiJTJCqTEL+\/6AGkMMKDOvI45w51FHGu3GqtwYBgbB\r\nG1ff2MVzMPNoZHYXAEsBwYjs0IFf2ay2US7ZSNDzfntPnnGQryQw7SU66ib\/N8f9\r\nU\/sITuMY2okt2u\/wFheEvfOGRq8fkzQNh7Tl0VsCgYEAwNLHBFvg\/F\/877mrLWFq\r\nLSzFXRrsHLv1bOvCdauIkbzIYz3iKBjNXOlWad6YnJzmyNlKmhQW6NF6CrD8VDPB\r\nnz\/bNoiL0KHPcgQvZgzR2AssQj5jkztwXzyLvP3ANmOLt5JZi+VKiiG48x3ytdUZ\r\ngdK6w47OhJsl5KfgMZSowA8=\r\n-----END PRIVATE KEY-----\r\n"}}' \
      $VAULT_ADDR/v1/tss2/data/tls_cert

  echo "Initializing TSS 3"
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"value": "{\"PaillierSK\":{\"N\":26795283137702680682928249296862530087842472246734793136745425103959797131946275785165380123246407347541301756608534399417315457621297828173799100415299038028000132400007033145208285975357270757349676475802290506334022575819711909048726984191229330686488645692766575512700815350477138871118264629456261245575818169248652012556458657614846527785238918007798503573524329415425634909433966472098690759475157567990295040713842313089421340490759563136309803284566724929689553851247027199218315480217785342029301299800845267212726702659481781642485092085828482087529504439014735616242894754686134401726498504177961361934173,\"LambdaN\":13397641568851340341464124648431265043921236123367396568372712551979898565973137892582690061623203673770650878304267199708657728810648914086899550207649519014000066200003516572604142987678635378674838237901145253167011287909855954524363492095614665343244322846383287756350407675238569435559132314728130622787745144005392029911347236343636798491944137624397554078492747961878651657896580917897840132068440220657417065768812273540144592041241733232904555384714876968365569545797913492391627142482822958858342086478228094807790438259988134089246680630567382818823048542511305501086220082767988639260236407896874346375534,\"PhiN\":26795283137702680682928249296862530087842472246734793136745425103959797131946275785165380123246407347541301756608534399417315457621297828173799100415299038028000132400007033145208285975357270757349676475802290506334022575819711909048726984191229330686488645692766575512700815350477138871118264629456261245575490288010784059822694472687273596983888275248795108156985495923757303315793161835795680264136880441314834131537624547080289184082483466465809110769429753936731139091595826984783254284965645917716684172956456189615580876519976268178493361261134765637646097085022611002172440165535977278520472815793748692751068,\"P\":172954130943874049238070010273458523122287507582033705181786044887978304227584807662572912031322578782673110936421182086222257268153211869437245544360307037235640788102071270597887490496507302608735336176521875010439781477289690493333654839695464655002460339403165136297658657744601617766551923741478471114247,\"Q\":154927106924078684526114917299472278228355251421361711357047446780353289413219828640437583306954547892787798239796583922909899140122884801063446970776663955722773971549128943837173704755632121703881790667867202586706044662215822970658075984998251794880947014588959477772795931405555505439473764642734198068859},\"NTildei\":26287095469882602259502960253155254360804319664057270189400555438054357337039614490548038307454671193615535895363160165395716478102599420425673849627176549512756025903516156113017789809445854157445538189888630423465309197773535791949509398585263047625717743386222018827777580573693980777100354534528660867076047014926437366102709599305753278778933593961568721564772996025784590013410301807035352087426157394490518039676044525664902377430194383257189430440590876636954585590235337308078794409472039895617243643395811418712000686126844715347501087676349248362549061632812724867306834763198717465818908662935792809313461,\"H1i\":7237296850102268809994391546422806771347421159582956353244469392173556245485887457113471982438691859952586948054041931864327489311127741289168937238696227543427161114005626119761194204840161333289011028101857213468065152804524954246351365273946276689599882908377802458781536966578763817065593945744764572690228246297840801885643084377214499585041076814427271051646943709207624302771267224258220858975367390613934384286047461793500454991574228495571945567704822616857994598586850247654535280319590421886683662233275827643945568263492469168667896177789512153268054577266692088605275176858300251672907083732758224300605,\"H2i\":18466749817946044150553924616420387687206097203280195091736108793324688078484955636193932153729736892592854146381201326144829913584998765092920657820383019994011038791187893733125656289003473873902534439014371112885776632378339360078278137714330073530807181523557193669920350571316763823451053180616837192996398055144521752057518902938931133591279480112693018857707713794810315766346454595609625905047554072392064316910915940533310037364560325306800203727643345507302326279358384562465006827568506035523943913412901074793452573117887015063684946946486775965102910635992776743190835788384535879618002669142951088681822,\"Alpha\":23117554482776287923815185169795695981757567945662710098031641486441947881649265365271273386263770953740935863059942122312285009258631179725741443391144436116994829519312826657526236949646552178668198337124392855535020775849792018939416731190074935154367192490277098235702951661208421136402298797262672005904967351957952899027250358843617695997858680454245269664217241000854107537505112465541350866057476386826310796414322718746088958954149354831361091532568088097047226482668772679699114702776371843617137947894639440817590959812516084816623024058680485779043753587623191994202920940324410560017853797724038877826436,\"Beta\":1132566243153808479225746000385719789311254050758712686435124578418360839993609856608293116344420260979097922883436305988388620065182888765471600251606105223647261918586935642407163880341206063399295560076090425016180744399947289166667837273090958510720514266044480485902818411738541707338242879440370481169868181737515371186384613322969647242830816536898331565454252327623797251806708798220322998263370701142369993846143132817216169932626880011898770602485129701390811136518669839758602342942766095694297920714214900275313962575607715826581610909427688531890587056661624392860000369165233848115036421452748660283773,\"P\":77714392845371388153195378034648821923180879986837047135308332090925837506214302625455715153652312734618196963640282412094711163539481513538494879036420970919370764889120725224428774180843818086913748113757413034049220109657819502159637084982369766722822976484623668308995298844271980494015822132189242146109,\"Q\":84563150104595593752399607605041212021595576333848847150402510468237250821413948617076592384933480271195419690701789471713502017927240972731916826791005138881925835684333581072319554466342678984195352390711933102727957625028717866189019028875684909382075856865158021465314101944235847951441541633598391916359}"}}' \
      $VAULT_ADDR/v1/tss3/data/keygen_preparams
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"value": "0x24b399d4959b59d91c51877f695211f4766755eec1632524357e6ba111d27b94"}}' \
      $VAULT_ADDR/v1/tss3/data/core_account
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"value": "{\"PaillierSK\":{\"N\":26795283137702680682928249296862530087842472246734793136745425103959797131946275785165380123246407347541301756608534399417315457621297828173799100415299038028000132400007033145208285975357270757349676475802290506334022575819711909048726984191229330686488645692766575512700815350477138871118264629456261245575818169248652012556458657614846527785238918007798503573524329415425634909433966472098690759475157567990295040713842313089421340490759563136309803284566724929689553851247027199218315480217785342029301299800845267212726702659481781642485092085828482087529504439014735616242894754686134401726498504177961361934173,\"LambdaN\":13397641568851340341464124648431265043921236123367396568372712551979898565973137892582690061623203673770650878304267199708657728810648914086899550207649519014000066200003516572604142987678635378674838237901145253167011287909855954524363492095614665343244322846383287756350407675238569435559132314728130622787745144005392029911347236343636798491944137624397554078492747961878651657896580917897840132068440220657417065768812273540144592041241733232904555384714876968365569545797913492391627142482822958858342086478228094807790438259988134089246680630567382818823048542511305501086220082767988639260236407896874346375534,\"PhiN\":26795283137702680682928249296862530087842472246734793136745425103959797131946275785165380123246407347541301756608534399417315457621297828173799100415299038028000132400007033145208285975357270757349676475802290506334022575819711909048726984191229330686488645692766575512700815350477138871118264629456261245575490288010784059822694472687273596983888275248795108156985495923757303315793161835795680264136880441314834131537624547080289184082483466465809110769429753936731139091595826984783254284965645917716684172956456189615580876519976268178493361261134765637646097085022611002172440165535977278520472815793748692751068,\"P\":172954130943874049238070010273458523122287507582033705181786044887978304227584807662572912031322578782673110936421182086222257268153211869437245544360307037235640788102071270597887490496507302608735336176521875010439781477289690493333654839695464655002460339403165136297658657744601617766551923741478471114247,\"Q\":154927106924078684526114917299472278228355251421361711357047446780353289413219828640437583306954547892787798239796583922909899140122884801063446970776663955722773971549128943837173704755632121703881790667867202586706044662215822970658075984998251794880947014588959477772795931405555505439473764642734198068859},\"NTildei\":26287095469882602259502960253155254360804319664057270189400555438054357337039614490548038307454671193615535895363160165395716478102599420425673849627176549512756025903516156113017789809445854157445538189888630423465309197773535791949509398585263047625717743386222018827777580573693980777100354534528660867076047014926437366102709599305753278778933593961568721564772996025784590013410301807035352087426157394490518039676044525664902377430194383257189430440590876636954585590235337308078794409472039895617243643395811418712000686126844715347501087676349248362549061632812724867306834763198717465818908662935792809313461,\"H1i\":7237296850102268809994391546422806771347421159582956353244469392173556245485887457113471982438691859952586948054041931864327489311127741289168937238696227543427161114005626119761194204840161333289011028101857213468065152804524954246351365273946276689599882908377802458781536966578763817065593945744764572690228246297840801885643084377214499585041076814427271051646943709207624302771267224258220858975367390613934384286047461793500454991574228495571945567704822616857994598586850247654535280319590421886683662233275827643945568263492469168667896177789512153268054577266692088605275176858300251672907083732758224300605,\"H2i\":18466749817946044150553924616420387687206097203280195091736108793324688078484955636193932153729736892592854146381201326144829913584998765092920657820383019994011038791187893733125656289003473873902534439014371112885776632378339360078278137714330073530807181523557193669920350571316763823451053180616837192996398055144521752057518902938931133591279480112693018857707713794810315766346454595609625905047554072392064316910915940533310037364560325306800203727643345507302326279358384562465006827568506035523943913412901074793452573117887015063684946946486775965102910635992776743190835788384535879618002669142951088681822,\"Alpha\":23117554482776287923815185169795695981757567945662710098031641486441947881649265365271273386263770953740935863059942122312285009258631179725741443391144436116994829519312826657526236949646552178668198337124392855535020775849792018939416731190074935154367192490277098235702951661208421136402298797262672005904967351957952899027250358843617695997858680454245269664217241000854107537505112465541350866057476386826310796414322718746088958954149354831361091532568088097047226482668772679699114702776371843617137947894639440817590959812516084816623024058680485779043753587623191994202920940324410560017853797724038877826436,\"Beta\":1132566243153808479225746000385719789311254050758712686435124578418360839993609856608293116344420260979097922883436305988388620065182888765471600251606105223647261918586935642407163880341206063399295560076090425016180744399947289166667837273090958510720514266044480485902818411738541707338242879440370481169868181737515371186384613322969647242830816536898331565454252327623797251806708798220322998263370701142369993846143132817216169932626880011898770602485129701390811136518669839758602342942766095694297920714214900275313962575607715826581610909427688531890587056661624392860000369165233848115036421452748660283773,\"P\":77714392845371388153195378034648821923180879986837047135308332090925837506214302625455715153652312734618196963640282412094711163539481513538494879036420970919370764889120725224428774180843818086913748113757413034049220109657819502159637084982369766722822976484623668308995298844271980494015822132189242146109,\"Q\":84563150104595593752399607605041212021595576333848847150402510468237250821413948617076592384933480271195419690701789471713502017927240972731916826791005138881925835684333581072319554466342678984195352390711933102727957625028717866189019028875684909382075856865158021465314101944235847951441541633598391916359,\"Xi\":84991395000925751257541480376053639620342360061864274324224082047034257447132,\"ShareID\":766418774313531105623098104317968735865501209001,\"Ks\":[625664809357144621199213330413524971235421323270,766418774313531105623098104317968735865501209001,916059140686050998083978944447064389845990912875],\"NTildej\":[27522048145569981576385476070657020085925130726339017105732055245635131139617848779486234236089392739447177029230176776337417792840985410026305811898446122370628457991480751841368787992944674212855827136776106587708211623816096633385470508783942777769060242860553024607789618299480333621903785949269589743855899844781732294719464609693176227125635396506961291206642890240986520873279868204630398583955556159431730110625063162375117211307543187824440584752056647328233594782678897603405275933516376239252164516303232640795307757685973412817046088426802943281427373371681705483044019813362572029248015450975003456793397,26287095469882602259502960253155254360804319664057270189400555438054357337039614490548038307454671193615535895363160165395716478102599420425673849627176549512756025903516156113017789809445854157445538189888630423465309197773535791949509398585263047625717743386222018827777580573693980777100354534528660867076047014926437366102709599305753278778933593961568721564772996025784590013410301807035352087426157394490518039676044525664902377430194383257189430440590876636954585590235337308078794409472039895617243643395811418712000686126844715347501087676349248362549061632812724867306834763198717465818908662935792809313461,23480415588435419031447079673342707638584619157635925492892092700956060545054581211317334723150904861647190443363724915913333634731042690202334969095297558918226065644052149284231228609885061347987303336592232342077541836117562828680125795146950913810227400817925439088111347951718821237533712931454939571041465013966764098136630139098758185943869375547993588616403453940445655380460537844392425662492015903802136973858968487213723069854403978084196943365237107277679727406895299211293901166051965782637942434024652916212091234932440173565058930379352547491346302287905973361117574863852150429835457489028946773862121],\"H1j\":[16517568479471580541042167147429887624339112445131695731362812965113271556999931499818506920295872359339618541473632721715590651347747155351693852424406909063273800991740936578905390940693930284712570022696272615200628747778340495713818589656470906148279108801537540281635961498936452198579197181393579833588271971375793237362898722119231386278352366524087073998056530952433549592269901646408479257883589277185145047553119070727427132500779070094700805261739909572847069577770555320557647528931722700347780859584941003633045209132957117021571486230238188597577097341756253345984078902464163897730250825619109443585525,7237296850102268809994391546422806771347421159582956353244469392173556245485887457113471982438691859952586948054041931864327489311127741289168937238696227543427161114005626119761194204840161333289011028101857213468065152804524954246351365273946276689599882908377802458781536966578763817065593945744764572690228246297840801885643084377214499585041076814427271051646943709207624302771267224258220858975367390613934384286047461793500454991574228495571945567704822616857994598586850247654535280319590421886683662233275827643945568263492469168667896177789512153268054577266692088605275176858300251672907083732758224300605,5244625320890758926823236807577436724284838598713053894859482410751817243781879176481630696209928554813580388949933383265760121927355967924125199634578244258322548509081654208382874250887126067143103657480563891927357049788066150009272405448366743698886019402037370394519945482107092906983297562458511070353876474628171257852523538903349915748196522993465048339465501002966487352363881955493353463137731082045334297957366902605993954637756964170953811640782160016128220626751514742583329029928572309497541088770781393935677741525856476779288748073006775582646889485680084355364188574749761390046121904185116946045566],\"H2j\":[7009260890983307674042645873443598272360402291874184297628611268334644375502827051885602971774872550746932684397961239936661508751942327338374679890949524040617402859819754169960008995120441085537975312375011245160932483701011029053912892591633122502853519566790980511469316278839843627242914384033499665339269445033918946320801864810354356251335317386995536622835031324684861929125151890912785727964237447305235539333445504406193442566504156368203203389831716945872865325564528075805169478948659002126911172399429651055487198066475747305990261540384572530954665466045817671514939564054758032645426132833343419966435,18466749817946044150553924616420387687206097203280195091736108793324688078484955636193932153729736892592854146381201326144829913584998765092920657820383019994011038791187893733125656289003473873902534439014371112885776632378339360078278137714330073530807181523557193669920350571316763823451053180616837192996398055144521752057518902938931133591279480112693018857707713794810315766346454595609625905047554072392064316910915940533310037364560325306800203727643345507302326279358384562465006827568506035523943913412901074793452573117887015063684946946486775965102910635992776743190835788384535879618002669142951088681822,14594346189095736747225884320665122466781709130296311799936140821845005707361969481771237336943241045846198194729530707984812596096197073779339845516025127003079087887760214159407509566512887375945758017191971067305459350608195289978927459042719267798647279892469529011521861358583760223133316545691872222500422769804045468217338943573175507344490987948897073607894657847841365159409323996140440196447829619732543872240361901392265668680831787448636887349391368628269910852040117529969597030556767165164122605145506454531225988854626670635330962899644382358608473267918441558783891780673214920504774987530770981704584],\"BigXj\":[{\"Curve\":\"secp256k1\",\"Coords\":[10595438597909221693748036930367535218954356641874811938509902668063892235679,40877866135104242373591861551464362310945480182503735785144669068942966547117]},{\"Curve\":\"secp256k1\",\"Coords\":[92793207823966202621751812820284297718761291093278899871726971928177640206077,92297913991377303798846750922249149640778764243812796171685353631556413999938]},{\"Curve\":\"secp256k1\",\"Coords\":[55900868197020429748489726670781890551991126161281129422810864018199515922765,25896859200074660682091578664718358181824979392968560255507974651069732695971]}],\"PaillierPKs\":[{\"N\":25222539396214102132947645117922233593416310527922261576767907607209454161148886976687740431574376057717301376863337351866485660948587280403504333047565362634864942355235574974370280655547038889388126778626768745495789937343074376983433409811121185054635688712486168781113695875463482736079503428210169676308334530833939254903788354387280861868113597976139498558860029324728905034236387595729540429364624198142499381828274695128146897507978696565574138170172578682300653201107201844796079327428944058588394275048046535588206168347669132263451197928497591448865056897551369647572951678065293218262773535109517570063301},{\"N\":26795283137702680682928249296862530087842472246734793136745425103959797131946275785165380123246407347541301756608534399417315457621297828173799100415299038028000132400007033145208285975357270757349676475802290506334022575819711909048726984191229330686488645692766575512700815350477138871118264629456261245575818169248652012556458657614846527785238918007798503573524329415425634909433966472098690759475157567990295040713842313089421340490759563136309803284566724929689553851247027199218315480217785342029301299800845267212726702659481781642485092085828482087529504439014735616242894754686134401726498504177961361934173},{\"N\":23949789292911593449510090425353172637070236362229751109169870170660074497909172961293310462873907002932545468074300537494304277845207045851997549356787128175383049248182587416414995106526129859920221044303102714478973195782211467295196796329468913412347036581448101530025176782014110769308326049264044433721591396377444569703626747403360277212347996478898918531541102343860198874119847987688888682820636176591093459578593615102261280505750205171369244044064814235203973794638759615390042916863073533489259278661362761417186511175522276964580366578308875060521309515076941359221298299863412994866078466202574042667573}],\"ECDSAPub\":{\"Curve\":\"secp256k1\",\"Coords\":[54395761864595184025289438248194755919131038527475290364574472112973735884319,19002356526498140446852353712213625197381438986713448406980976582657340900049]}}"}}' \
      $VAULT_ADDR/v1/tss3/data/tss_share
  curl \
      --header "X-Vault-Token: $VAULT_TOKEN" \
      --header "Content-Type: application/json" \
      --request POST \
      --data '{"data": {"cert_data": "-----BEGIN CERTIFICATE-----\r\nMIIDHDCCAgSgAwIBAgIUMjiyAUb8Seipi5N5EllGRzqI9jYwDQYJKoZIhvcNAQEL\r\nBQAwEjEQMA4GA1UEAwwHcGFydHktMzAeFw0yNTAzMTkxNzMyNDdaFw0yNjAzMTkx\r\nNzMyNDdaMBIxEDAOBgNVBAMMB3BhcnR5LTMwggEiMA0GCSqGSIb3DQEBAQUAA4IB\r\nDwAwggEKAoIBAQCa2cUDTnJOMUvSRmBjM3AbG3DfjAakKefGr8aUvQ4ADK93ezMT\r\nQQ77fhe3sJXckn2mAR3\/ohOnMXZHUPkF59EOjSXXhFHJOcpaUEFTf0+C0FFKnjxN\r\n0Lkl\/ZZYqdZgUIY9VHVBaR3lQT9NXYa10JMkrkecNuEyX9lvAn4FsZhTLAQKytg2\r\njQ4EUQUQIaiDWaB5m6YthmCL+bES8puuHGkdQ5kGTAcUW4rGhlgU0YgNebt\/RDKI\r\npwr2UaDuqAOetdvTiVHdkiEHje5zb+XiSZWKKChEBCQD1l1+hcQC+5c2k7PbgNEq\r\nBuF5Gnk3tcEf3Jol23Rfdd0aXPm0qMjbsZwTAgMBAAGjajBoMBAGA1UdEQQJMAeC\r\nBXRzcy0zMAkGA1UdEwQCMAAwCwYDVR0PBAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUF\r\nBwMBBggrBgEFBQcDAjAdBgNVHQ4EFgQU6opO0JUnebUp20SaCFn9XR+xW7owDQYJ\r\nKoZIhvcNAQELBQADggEBAEplWzD5nR3oRCpUT981Jhjs6OGRqetcxAg5xhuDwJmG\r\nByL1omV\/ydAZt50GCRe3nipWzJ0XdX\/+RzmTAudjzrjAMeawsfqZ1XubWjxhA45k\r\nVrYDBuhtfF5uGzaHPaBOlhqjPSa\/lX27C6zHd6g1VIc6A09pMOrEtO8XQCaD5\/NO\r\nA9Yernj1mvbaju6bPlD93v9g0yma4gNfkQXVARMWPOSTsnH9MvWT9rqFVR9lQGVo\r\nRvhOFt\/z\/pxr3PUmwLcBulj025tCF3Xg6CcEbNGEzr2OuZK8wBO2mRyM4NklMXD8\r\n+AYWRXEOHybCNjnn\/g04lpxzlckrRByHzyS02vMp7sQ=\r\n-----END CERTIFICATE-----\r\n","key_data":"-----BEGIN PRIVATE KEY-----\r\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCa2cUDTnJOMUvS\r\nRmBjM3AbG3DfjAakKefGr8aUvQ4ADK93ezMTQQ77fhe3sJXckn2mAR3\/ohOnMXZH\r\nUPkF59EOjSXXhFHJOcpaUEFTf0+C0FFKnjxN0Lkl\/ZZYqdZgUIY9VHVBaR3lQT9N\r\nXYa10JMkrkecNuEyX9lvAn4FsZhTLAQKytg2jQ4EUQUQIaiDWaB5m6YthmCL+bES\r\n8puuHGkdQ5kGTAcUW4rGhlgU0YgNebt\/RDKIpwr2UaDuqAOetdvTiVHdkiEHje5z\r\nb+XiSZWKKChEBCQD1l1+hcQC+5c2k7PbgNEqBuF5Gnk3tcEf3Jol23Rfdd0aXPm0\r\nqMjbsZwTAgMBAAECggEABUdLGfPAnb28ceyIOJl2RtZGoLgrOclb5z\/yqvtO0N2d\r\n1ZrTgOKE2jnQISjZ0u0Db3c2SJKDzP04pPGzq2ndjHtvQMt35j4cEbwOngQG99SW\r\nEM8YCycESLE+QMN5VUspaEnKvXIR3NC+kaqQfv4fJe7y7fZI8uilhs008oi9Qoh9\r\n9\/0R+DuSQzsC8iJ2gYApg+ZBQaEBc2oJ0NKxpVZWY9bh+btEyQ5xf1YXQPspWyFS\r\nHXJyGRHw6AmPNYFvSWqKu4PLE37eNQM5K6up1HM+yHkN5QlTDKN+R\/QgDFrRD8fG\r\nAEonk3FNyIVfpwjtndKHq8YlcIHggvIZX4YtjWFHoQKBgQDU7agTRGFv6r7xhy83\r\n7WCmoLzxrr7WI9hS955RhdO1RhWDuR3TaJFxIMSbSOqBDWIE2T\/dyl\/UxjnbYK5a\r\n4KXUoHAkb2SgUPL5DeJz239EwPQ+0QVq\/KaCoXDk3Lu3fNOF9xQpFfT0AldR271o\r\nzcgkwgLGvUGraS1qRWQ9lji2KQKBgQC6LJnzUkBqq6UUF1a\/41xTc5irzKwk1F1F\r\n8Y8i9o19RjBlcip5w7aOU\/wcs8pXLoop1zo94VbMiTFMMYovLTyzxQd2ZI7wzHF0\r\nffrS9Xpq8gQzAd3wfsJtmweUJpvYGBRQuKHXy4vxYVDFOJvonxHEMeeqWaFmFM+5\r\nazGgouJv2wKBgQC\/rGwXY\/\/eUk+udkWwL7RIavuLCAXsGHpcPWE7+59XWA539AUA\r\nUOpUDu5M5veKUnTA7pwKWGmpzQM6Ey8Ayacd34rzkX7gvd3rCm+mYZmQV63GejxJ\r\nUcPGZfONYZJtmyWCO6ffUE+f9BeMraU0mcGoLSl4o9dgqR5jwrF4qyjD+QKBgDWP\r\nO0L6+Lk3ZChhhn1xxU\/kw5k5KpT121eR5OHkGFRf6vBkZb\/eBBjyJGeFecKXCvx6\r\nhLDksPnqxhnrbpuf4gS9vCXdTBoOVt1ymMQ0BuHZekfKU7UqYnjxzr5aVR9X3hBS\r\n7YyNbFcm7fuvC3tit9O\/n6wsWPhrKE9pfT9\/XLFdAoGBAIev5M8hsN897yPTIsod\r\n8lzR1pBbhwHIFUE7zAYB9VA7KqsXgFf7r7S4OWv92Jkq+qcJGRAP53JHWXbf2xhk\r\nzDoLH5w\/J3tSPt5eAvPwBKZWhKJAyRWlfw8f9iiC5\/nB2gg9o3GkpmnNnGP5nbva\r\nidyUsZY29sxLQMSlfaBUgqGJ\r\n-----END PRIVATE KEY-----\r\n"}}' \
      $VAULT_ADDR/v1/tss3/data/tls_cert
}

echo "Initializing Vault..."

wait_vault

if check_vault_init; then
  echo "Initialization complete. Exiting."
  exit 0
fi

init_tss
